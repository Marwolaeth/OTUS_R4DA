---
title   : "Утилита формирования отчётов Quarto"
subtitle: "Язык R для анализа данных"
author  : ""
date    : 2023-06-13
format  :
  pptx  :
    reference-doc: ../tools/template.pptx
    incremental: true
    mermaid-format: png
    include-in-header:
      - text: |
          \usepackage{amsmath}
          \usepackage{mathtools}
          \usepackage{icomma}
          \usepackage{russlh}
resource-path: 
  - "../images"
default-image-extension: "png"
execute:
  echo   : false
  eval   : true
  warning: false
---

## Webinar setup

Insert webinar setup slide here

## About

Insert about slide here

## Webinar rules

Insert webinar rules slide here

## Webinar path

Insert webinar path slide here

# Почему Quarto?

## Что за Quarto? (1 из 2)

Quarto (отсылка к формату `in quarto`) -- система публикации документов от Posit (бывшая RStudio, создатели `Tidyverse`).

Quarto -- не библиотека R, а автономное приложение с интерфейсом командной строки. Например, вы можете:

1.  Создать документ `document.qmd` в своем любимом редакторе.
2.  Добавить YAML-метаданные (как Rmarkdown, но см. ниже).
3.  Сверстать документ в нужном вам формате:

```       
quarto render document.qmd
```

## Что за Quarto? (2 из 2)

RStudio IDE новых версий включает Quarto, а также предоставляет для него редактор кода с автозаполнением и удобный визуальный редактор.

Quarto имеет более широкие по сравнению с Rmarkdown возможности. Можно воспринимать его как:

 

-   Rmarkdown++
-   MS Word с гибридным интерфейсом
-   Dreamweaver для аналитиков и ученых

## Что нового: не только R

Quarto умеет обрабатывать код на следующих языках:

-   R
-   Python
-   Julia
-   Observable

![](languages_grey)

## Что нового: множество форматов вывода «из коробки»

Quarto поддерживает множество форматов вывода, включая HTML, PDF, EPUB и другие. В Rmarkdown для большинства этих форматов необходимы дополнительные библиотеки:

| **Возможности Quarto**    | **Реализация в Rmarkdown** |
|---------------------------|----------------------------|
| HTML                      | ✓                          |
| PDF                       | ✓                          |
| DOCX/ODT                  | ✓                          |
| PowerPoint                | ✓                          |
| сайт/блог                 | `distill`, `blogdown`      |
| HTML-презентация          | `revealjs`                 |
| книга                     | `bookdown`                 |
| интерактивная презентация | `flexdashboard`            |

## Что нового: модульный дизайн (1 из 3)

Quarto позволяет разбивать анализ на маленькие, повторно используемые компоненты, которые можно собирать в сложные документы. Это делает повторное использование и комбинирование частей вашего анализа легким.

Сложный проект на R может состоять из нескольких скриптов, содержащих загрузку и предобработку данных, специальные функции, моделирование и визуализацию. Quarto позволяет точно так же использовать файлы `.qmd`: собирать их в большие проекты, использовать вывод одной ячейки кода много раз.

## Что нового: модульный дизайн (2 из 3)

Пример: включить все объекты из файла `_data.qmd`

```         
{{< include _data.qmd >}}
```

Некоторые примеры того, что можно заимствовать из других документов:

-   Код загрузки и очистки данных
-   Статистические анализы или модели
-   Визуализации (диаграммы, графики, карты и т. д.)
-   Объяснительный текст с уравнениями, изображениями и т. д.
-   Интерактивные выводы (бегунки, списки и т. д.)
-   Библиографическая информация

## Что нового: модульный дизайн (3 из 3)

Некоторые преимущества модульных документов включают:

1.  Повторное использование: можно повторно использовать те же ячейки в нескольких документах

2.  Гибкость: можно повторно комбинировать ячейки разными способами для разных выводов или целей

3.  Абстракция: скрывать детали реализации от читателей документа

4.  Удобство поддержки: нужно вносить изменения только в одном месте

## Что нового: расширенное форматирование

Quarto изначально включает все необходимое для научных публикаций и [воспроизводимого анализа](https://habr.com/ru/articles/417469/):

-   обширную поддержку перекрестных ссылок и цитат;
-   расширенное аннотирование рисунков, таблиц и кода;
-   нативную поддержку графов и блок-схем (`mermaid` и `Graphviz`)
-   расширенные возможности написания формул LaTeX.

**Пример**: Запись матрицы (пакет `amsmath`)

$$A = \begin{pmatrix}4&-3&-3\\1&2&1\\1&1&2\end{pmatrix}$$ **Пример**: Запятая как десятичный разделитель (пакет `icomma`)

$$x = 1,11,\, y = 2,18,\, \pi = 3,141593\dots$$

::: notes
Запятая в качестве десятичного разделителя -- стандарт математической записи в России (установлен сразу несколькими ГОСТами) и в большинстве стран Европы, Южной Америки и Африки.
:::

## Что нового: интерактивное и динамическое содержимое

Quarto поддерживает интерактивное и динамическое содержимое с использованием JavaScript и других веб-технологий. Это позволяет создавать документы с интерактивными графиками, анимацией и другими динамическими функциями. Для создания интерактивного документа выберите один из следующих форматов:

-   Shiny
-   Observable JS

## Что нового: настраиваемые шаблоны и брендирование

Quarto позволяет настраивать шаблоны и темы, которые можно использовать для управления внешним видом ваших документов. Это облегчает создание профессиональных документов с единым визуальным стилем.

![Пример брендинга](branding-example)

::: notes
Данная презентация создана в Quarto на основе шаблона Otus!
:::

# Алгоритм работы

## Общий алгоритм проектов Quarto

```{mermaid quarto-general}
flowchart LR
  A{Выбираем тип проекта} --> B(Редактируем YAML)
  B --> C(Пишем текст и код)
  B --> D(Добавляем изображения)
  C --> E(Настраиваем отображение)
  D --> E
  E <--> B
  E --> F[Публикация]
  
  classDef optional stroke-dasharray:10;
  class D optional
```

## Типы проекта

```{mermaid quarto-types}
flowchart TD
 typeD>Документ]
 typeP>Презентация]
 typeI>Интерактивный HTML]
 
 formatPDF[PDF]
 formatHTML[Статичный HTML]
 formatWord[Word/ODT]
 
 formatPP[PowerPoint]
 formatRJS[Reveal JS]
 formatBeamer[Beamer]
 
 formatShiny[Shiny]
 formatOJS[Observable JS]
 
 typeD --> formatPDF & formatHTML & formatWord
 typeP --> formatPP  & formatRJS &  formatBeamer
 typeI --> formatShiny  & formatOJS
```

## YAML-заголовки (1 из 2)

YAML («**Y**AML **A**in't **M**arkup **L**anguage») – язык сериализации данных, как JSON и XML. Используется Quarto для записи конфигурации проекта (как в R и Julia). Формат записи – `опция: значение`.

Код конфигурации YAML отделяется тремя дефисами сверху и снизу:

``` yaml
---
title : "Hello, Quarto"
author: "otus.ru"
date  : 2023-06-13
format:
  pptx:
    reference-doc: ../templates/template.pptx
    mermaid-format: png
---
```

## YAML-заголовки (2 из 2)

Опции Quarto делятся на:

- общие;
- формат-специфичные (записываются под `format: [ваш формат]:`).

Для каждого из форматов существует до нескольких десятков опций. Полный список есть на [сайте Quarto](https://quarto.org/docs/reference/).

## Фрагменты кода

Как и для Rmarkdown, возможность интерпретировать код и встраивать результаты его исполнения в документ является основной функциональной особенностью Quarto.

В Quarto опции для отдельного фрагмента кода, если они нужны, записываются внутри блока в формате YAML и начинаются с `#|`:

```` markdown
```{{r}}
#| label: load-packages
#| include: false

library(tidyverse)
library(tidymodels)
```
````

# Пример проекта: статья + интерактивное приложение

## Code

When you click the **Render** button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

<!-- Прощальная сова -->

---
 
